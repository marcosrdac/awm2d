tentar subtrair só a onda direta
dx != dz
offset local
modularizar os códigos
